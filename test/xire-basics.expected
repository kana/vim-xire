Testing xire-basics ...                                          Testing xire-basics ===========================================================
<define-xire-macro>------------------------------------------------------------
test It should define a xire macro in the current environment., expects (#f (< (original-form) = context >)) ==> ok
<define-xire-statement>--------------------------------------------------------
test It should define a xire statement in the current environment., expects ((style a AAA) (style a AAA b BBB) (style a AAA rest (BBB CCC))) ==> ok
test It should define a macro which raises error for non-statement context., expects #<<error>> ==> ok
<xire-compile>-----------------------------------------------------------------
test It should raise error for a malformed script: (), expects #<<error>> ==> ok
test It should raise error for a malformed script: 'invalid-expression, expects #<<error>> ==> ok
test It should raise error for a malformed script: (no-such-macro), expects #<<error>> ==> ok
test It should raise error for a malformed script: (macro invlaid argument), expects #<<error>> ==> ok
test It should succeed to compile a valid script., expects ("\"" "I am a comment!") ==> ok
<xire-context related stuffs>--------------------------------------------------
test <xire-context> should be available., expects #<class <xire-context>> ==> ok
test make-statement-context should make a proper instance., expects (#<class <xire-context>> statement) ==> ok
test make-expression-context should make a proper instance., expects (#<class <xire-context>> expression) ==> ok
test statement-context?, expects (#t #f) ==> ok
test expression-context?, expects (#f #t) ==> ok
test ensure-statement-context should not complain for a proper context., expects #t ==> ok
test ensure-statement-context should complain for an improper context., expects #<<error>> ==> ok
test ensure-expression-context should not complain for a proper context., expects #t ==> ok
test ensure-expression-context should complain for an improper context., expects #<<error>> ==> ok
<xire-environment>-------------------------------------------------------------
test It should exist., expects #t ==> ok
test It should have some entries in its macro table by default., expects #t ==> ok
test It should be a parameter., expects (overridden <xire-environment>) ==> ok
<xire-environment-copy>--------------------------------------------------------
test It should copy the current environment, expects ((#t #t) (#f #t) ((a) (a b))) ==> ok
test It should copy a given environment, expects ((#t #f #f) (#f #t #t) (#f #f #t) ((a) (b) (b c))) ==> ok
<xire-lookup-macro>------------------------------------------------------------
test It should return #f if there is no macro with the given name., expects #f ==> ok
test It should return the expander of a registered macro., expects (expanded-form (original-form)) ==> ok
test It should look up macro from a given environment., expects ((default-environment #f given-environment #f) (default-environment #f given-environment #t)) ==> ok
<xire-register-macro!>---------------------------------------------------------
test It should register a macro into the current environment., expects 1 ==> ok
test It should register a macro into a given environment., expects ((default-environment 0 given-environment 0) (default-environment 0 given-environment 1)) ==> ok
<xire-translate>---------------------------------------------------------------
test It should raise error for a malformed script: (), expects #<<error>> ==> ok
test It should raise error for a malformed script: 'invalid-expression, expects #<<error>> ==> ok
test It should raise error for a malformed script: (no-such-macro), expects #<<error>> ==> ok
test It should raise error for a malformed script: (macro invlaid argument), expects #<<error>> ==> ok
test It should succeed to compile a valid script: (macro vlaid argument), expects "\"valid argument" ==> ok
test It should succeed to compile the empty script., expects "" ==> ok
passed.
passed.
